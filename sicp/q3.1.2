(define (estimate-pi trials)
    (sqrt (/ 6 (monte-carlo trials experiment)))
)
(define (experiment)
    (= 1 (gcd (random 100000) (random 100000)))
)
(define (monte-carlo trials experiment)
    (define (iter remain trials-passed)
        (if (= 0 remain) 
            (/ trials-passed trials)
            (if (experiment)
                (iter (- remain 1) (+ 1 trials-passed))
                (iter (- remain 1) trials-passed)
            )
        )
    )
    (iter trials 0)
)

(estimate-pi 100)
(estimate-pi 1000)
(estimate-pi 10000)
(estimate-pi 100000)
